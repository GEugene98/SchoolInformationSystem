<form #uploadForm><input type="file" (change)="uploadExcel(uploadForm)" #fileInput name="f" style="display:none" /></form>

<div class="pane">
    <button class="btn btn-success" (click)="openPreImportModal(preImportModal)">Импорт КТП <span class="glyphicon glyphicon-open" aria-hidden="true"></span> </button>
</div>

<table class="table">
  <thead>
    <tr>
        <th scope="col">Дата</th>
        <th scope="col">Содержание/Тема</th>
        <th scope="col">Часы</th>
        <th scope="col">Примечание</th>
        <th scope="col">Действия</th>
    </tr>
  </thead>
  <tbody>
    <tr *ngFor="let record of records">
      <td>{{record.date | date}}</td>
      <td>{{record.name}}</td>
      <td>{{record.hours}}</td>
      <td>{{record.comment}}</td>
      <td>
        <div class="action-icons">
          <a title="Редактировать" href="javascript:void(0)"><span style="color: purple" class="glyphicon glyphicon-pencil" aria-hidden="true"></span></a>
          <a title="Удалить" href="javascript:void(0)" ><span style="color: red" class="glyphicon glyphicon-remove" aria-hidden="true"></span></a>
        </div>
      </td>
    </tr>
  </tbody>
</table>

<ng-template #preImportModal>
  <div class="modal-header"> 
      <h4 class="modal-title pull-left">Параметры импорта КТП из Excel документа</h4>
      <button type="button" class="close pull-right" aria-label="Close" (click)="modalRef.hide()">
          <span aria-hidden="true">&times;</span>
      </button>
  </div>
  <div class="modal-body pre-import-modal">
    Укажите диапазоны ячеек, в которых будет происходить считывание данных. <br/>
    Если в документе отсутсвует какой-либо столбец - просто не указывайте диапазон ячеек.<br/>
    Количество ячеек по каждому столбцу должно быть одинаковым! <br/>
    Например, вы указали диапазон ячеек по столбцу дат A1:A3, 
    следовательно диапазоны ячеек в других столбцах должны охватывать 3 ячейки.  
    <br/>
    <br/>
      Диапазон ячеек, содержащих дату:<br/>
      <div>
          <input type="text" [(ngModel)]="importModel.dateRange" class="form-control" placeholder="А1:A5">
      </div>
      Диапазон ячеек, содержащих тему:<br/>
      <div>
          <input type="text" [(ngModel)]="importModel.nameRange" class="form-control" placeholder="B1:B5">
      </div>
      Диапазон ячеек, содержащих часы:<br/>
      <div >
          <input type="text" [(ngModel)]="importModel.hoursRange" class="form-control" placeholder="C1:C5">
      </div>
      Диапазон ячеек, содержащих примечание:<br/>
      <div >
          <input type="text" [(ngModel)]="importModel.commentRange" class="form-control" placeholder="D1:D5">
      </div>

      <div style="text-align:center; margin-top: 15px;">
          <button type="button" (click)="closeModal()" class="btn btn-danger">Отмена</button>
          <button type="button" (click)="fileInput.click()" class="btn btn-success">Выбрать файл и начать импорт</button>
      </div>
  </div>

</ng-template>

<p-toast [baseZIndex]="1000"></p-toast>