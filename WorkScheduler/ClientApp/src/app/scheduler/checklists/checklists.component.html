<h1>Чек-листы</h1>

<div style="text-align: left">
    <button type="button" (click)="openModal(add)" class="btn btn-success">Создать чек-лист</button>
</div>


<div *ngIf="!checklists" class="lds-ring"><div></div><div></div><div></div><div></div></div>

<div style="display: flex; flex-direction: row; flex-wrap: wrap;">
    <div *ngFor="let checklist of checklists" class="panel panel-default"
        style="max-width: 440px; min-width: 440px; margin: 5px">
        <div class="panel-heading" style="display: flex; justify-content: space-between">
            <div style="word-wrap: break-word; width: 90%; font-weight: bold;">{{checklist.name}}</div>
            <div style="width: 15px; display: inline-block;">
                <a title="Редактировать" href="javascript:void(0)" (click)="copy(action); openModal(edit);">
                    <span style="color: purple" class="glyphicon glyphicon-pencil" aria-hidden="true">
                    </span>
                </a>
            </div>
        </div>
        <div class="panel-body">
            <div>
                <div *ngIf="!(checklist.assignedCount == 0 && checklist.acceptedCount == 0 && checklist.doneCount == 0)"
                    style="width: 120px; float: left;">
                    <p-chart [width]="250" type="doughnut" [options]="checklist.chartData.options"
                        [data]="checklist.chartData">
                    </p-chart>
                </div>

                <div style="text-align: left; display: inline-block; max-width: 260px; margin-left: 10px; margin-top: 2px;">
                    <div>
                        <p>Всего заданий: {{checklist.totalCount}}</p>
                    </div>
                    <div>
                        <p>Срок выполнения: {{checklist.deadline | date : 'dd.MM.yyyy'}}</p>
                    </div>
                    <div style="word-wrap: break-word;">
                        <p>Комментарий:<br /> {{checklist.comment}}</p>
                    </div>
                </div>
            </div>
            <div>
                <button style="margin-top: 20px;" type="button" [routerLink]="['//scheduler/checklist-details', checklist.id]" class="btn-tasks btn btn-info btn-block">Перейти к заданиям чеклиста</button>
            </div>

        </div>
    </div>
</div>

<ng-template #add>
    <div class="modal-header">
      <h4 class="modal-title pull-left">Создание чек-листа</h4>
      <button type="button" class="close pull-right" aria-label="Close" (click)="modalRef.hide()">
        <span aria-hidden="true">&times;</span>
      </button>
    </div>
    <div class="modal-body">
      <div style="margin-top: -10px">
        Наименование:
        <input type="text" [(ngModel)]="newChecklist.name" class="form-control" placeholder="Название чек-листа">
      </div>
  
      <div>
        Срок выполнения:
        <input type="text"
               placeholder="Щелкните здесь для выбора"
               class="form-control"
               [(ngModel)]="newChecklist.deadline"
               AUTOCOMPLETE="off"
               [bsConfig]="bsConfig"
               bsDatepicker>
      </div>

      <div>
        Комментарий(не обязательно):
        <textarea [(ngModel)]="newChecklist.comment" class="form-control" placeholder="Комментарий"></textarea>
      </div>
  
      <div style="text-align:center; margin-top: 15px;">
        <button type="button" (click)="closeModal()" class="btn btn-danger">Отмена</button>
        <button type="button" (click)="addChecklist()" class="btn btn-success">Сохранить</button>
      </div>
  
    </div>